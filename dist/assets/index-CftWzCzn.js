var ye=Object.defineProperty,ve=Object.defineProperties;var we=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var Ce=Object.prototype.hasOwnProperty,ke=Object.prototype.propertyIsEnumerable;var Q=(t,r,a)=>r in t?ye(t,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[r]=a,y=(t,r)=>{for(var a in r||(r={}))Ce.call(r,a)&&Q(t,a,r[a]);if(oe)for(var a of oe(r))ke.call(r,a)&&Q(t,a,r[a]);return t},E=(t,r)=>ve(t,we(r));var Ee=(t,r)=>()=>(r||t((r={exports:{}}).exports,r),r.exports);var q=(t,r,a)=>Q(t,typeof r!="symbol"?r+"":r,a);var I=(t,r,a)=>new Promise((s,i)=>{var c=d=>{try{n(a.next(d))}catch(p){i(p)}},m=d=>{try{n(a.throw(d))}catch(p){i(p)}},n=d=>d.done?s(d.value):Promise.resolve(d.value).then(c,m);n((a=a.apply(t,r)).next())});import{r as g,a as Ie,b as Se}from"./vendor-Ck2WTvpr.js";import{c as Pe,a as Te,u as De,b as Ae,d as Le,P as Re}from"./redux-CiEkc1Rc.js";import{u as Fe,a as Oe,B as Me,R as _e,b as Z,N as $e}from"./router-BdgCWWUQ.js";var xt=Ee(F=>{(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const m of c.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&s(m)}).observe(document,{childList:!0,subtree:!0});function a(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(i){if(i.ep)return;i.ep=!0;const c=a(i);fetch(i.href,c)}})();var ue={exports:{}},z={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ue=g,We=Symbol.for("react.element"),Be=Symbol.for("react.fragment"),qe=Object.prototype.hasOwnProperty,He=Ue.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ve={key:!0,ref:!0,__self:!0,__source:!0};function xe(t,r,a){var s,i={},c=null,m=null;a!==void 0&&(c=""+a),r.key!==void 0&&(c=""+r.key),r.ref!==void 0&&(m=r.ref);for(s in r)qe.call(r,s)&&!Ve.hasOwnProperty(s)&&(i[s]=r[s]);if(t&&t.defaultProps)for(s in r=t.defaultProps,r)i[s]===void 0&&(i[s]=r[s]);return{$$typeof:We,type:t,key:c,ref:m,props:i,_owner:He.current}}z.Fragment=Be;z.jsx=xe;z.jsxs=xe;ue.exports=z;var e=ue.exports,pe,ce=Ie;pe=ce.createRoot,ce.hydrateRoot;const V=t=>{const a=t>=5e4?0:5e3;return{productAmount:t,baseFee:2500,deliveryFee:a,totalAmount:t+2500+a}},X=t=>Array.isArray(t)?t.reduce((r,a)=>r+a.product.price*a.quantity,0):0,U={currentStep:1,product:null,customer:{firstName:"",lastName:"",email:"",phone:""},creditCard:{cardNumber:"",cardHolder:"",expiryDate:"",cvv:"",cardType:null},delivery:{address:"",city:"",department:"",postalCode:"",recipientName:"",recipientPhone:""},fees:{productAmount:0,baseFee:2500,deliveryFee:5e3,totalAmount:7500},transaction:{transactionId:"",status:"pending",message:"",productNewStock:0,wompiTransactionId:"",reference:"",amount:0},loading:!1,error:null,cartItems:[],cartTotal:0},he=Pe({name:"payment",initialState:U,reducers:{setCurrentStep:(t,r)=>{t.currentStep=r.payload},nextStep:t=>{t.currentStep<5&&(t.currentStep=t.currentStep+1)},previousStep:t=>{t.currentStep>1&&(t.currentStep=t.currentStep-1)},setProduct:(t,r)=>{t.product=r.payload},setCustomerInfo:(t,r)=>{t.customer=r.payload},setCreditCardInfo:(t,r)=>{t.creditCard=r.payload},setDeliveryInfo:(t,r)=>{t.delivery=r.payload},setTransactionInfo:(t,r)=>{t.transaction=r.payload},addToCart:(t,r)=>{Array.isArray(t.cartItems)||(t.cartItems=[]);const a=t.cartItems.find(s=>s.product.id===r.payload.id);a?a.quantity+=1:t.cartItems.push({product:r.payload,quantity:1}),t.cartTotal=X(t.cartItems),t.fees=V(t.cartTotal)},removeFromCart:(t,r)=>{if(!Array.isArray(t.cartItems)){t.cartItems=[];return}t.cartItems=t.cartItems.filter(a=>a.product.id!==r.payload),t.cartTotal=X(t.cartItems),t.fees=V(t.cartTotal)},updateCartItemQuantity:(t,r)=>{if(!Array.isArray(t.cartItems)){t.cartItems=[];return}const a=t.cartItems.find(s=>s.product.id===r.payload.productId);a&&(a.quantity=r.payload.quantity,a.quantity<=0&&(t.cartItems=t.cartItems.filter(s=>s.product.id!==r.payload.productId))),t.cartTotal=X(t.cartItems),t.fees=V(t.cartTotal)},clearCart:t=>{t.cartItems=[],t.cartTotal=0,t.fees=V(0)},setLoading:(t,r)=>{t.loading=r.payload},setError:(t,r)=>{t.error=r.payload},resetPaymentFlow:t=>{t.currentStep=1,t.customer=U.customer,t.creditCard=U.creditCard,t.delivery=U.delivery,t.transaction=U.transaction,t.loading=!1,t.error=null},resetEverything:()=>y({},U)}}),{setCurrentStep:G,nextStep:jt,previousStep:bt,setProduct:ze,setCustomerInfo:Ge,setCreditCardInfo:Ke,setDeliveryInfo:Ye,setTransactionInfo:Je,addToCart:Qe,removeFromCart:se,updateCartItemQuantity:fe,clearCart:Ze,setLoading:Nt,setError:yt,resetPaymentFlow:vt,resetEverything:ge}=he.actions,Xe=he.reducer,je="wompi_payment_state",ee={currentStep:1,cartItems:[],cartTotal:0,customer:{firstName:"",lastName:"",email:"",phone:""},creditCard:{cardNumber:"",cardHolder:"",expiryDate:"",cvv:"",cardType:null},delivery:{address:"",city:"",department:"",postalCode:"",recipientName:"",recipientPhone:""},fees:{productAmount:0,baseFee:2500,deliveryFee:5e3,totalAmount:7500},transaction:{transactionId:"",status:"pending",message:"",productNewStock:0,wompiTransactionId:"",reference:"",amount:0},loading:!1,error:null},et=t=>{try{const r=JSON.stringify(t);localStorage.setItem(je,r)}catch(r){}},tt=()=>{try{const t=localStorage.getItem(je);if(t===null)return ee;const r=JSON.parse(t);return y(y({},ee),r)}catch(t){return ee}},de=tt(),re=Te({reducer:{payment:Xe},preloadedState:de?{payment:de}:void 0,middleware:t=>t({serializableCheck:!1})});re.subscribe(()=>{et(re.getState().payment)});const B=()=>De(),K=Ae,st="https://back-pasarela.onrender.com",rt={get(t){return I(this,null,function*(){const r=yield fetch(`${st}${t}`,{headers:{"ngrok-skip-browser-warning":"true"}});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return yield r.json()})}},te={getAllProducts(){return I(this,null,function*(){const t=yield rt.get("/api/products");if(!t.success)throw new Error(t.message||"Error al obtener los productos");return t.data})}},at=({cardNumber:t})=>{const[r,a]=g.useState(null);return g.useEffect(()=>{const s=t.replace(/\D/g,"");if(s.length<1){a(null);return}if(s.charAt(0)==="4"){a("visa");return}if(s.length>=2){const i=parseInt(s.substring(0,2));if(i>=51&&i<=55){a("mastercard");return}}if(s.length>=4){const i=parseInt(s.substring(0,4));if(i>=2221&&i<=2720){a("mastercard");return}}if(s.length>=2){const i=parseInt(s.substring(0,2));if(i>=22&&i<=27){a("mastercard");return}}a(null)},[t]),r?e.jsxs("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 z-30 pointer-events-none",children:[r==="visa"&&e.jsx("div",{className:"flex items-center bg-white rounded-md px-2 py-1 shadow-lg border border-gray-200",children:e.jsx("img",{src:"/visa-logo.svg",alt:"Visa",className:"h-4 w-auto",onError:s=>{s.currentTarget.style.display="none",s.currentTarget.parentElement.innerHTML='<span class="text-blue-600 font-bold text-xs">VISA</span>'}})}),r==="mastercard"&&e.jsx("div",{className:"flex items-center bg-white rounded-md px-2 py-1 shadow-lg border border-gray-200",children:e.jsx("img",{src:"/mastercard-logo.svg",alt:"Mastercard",className:"h-4 w-auto",onError:s=>{s.currentTarget.style.display="none",s.currentTarget.parentElement.innerHTML='<span class="text-red-600 font-bold text-xs">MC</span>'}})})]}):null},nt=({isOpen:t,onClose:r})=>{const a=B(),[s,i]=g.useState({firstName:"",lastName:"",email:"",phone:"",cardNumber:"",cardHolder:"",expiryDate:"",cvv:"",address:"",city:"",department:"",postalCode:"",recipientName:"",recipientPhone:""}),[c,m]=g.useState("personal"),[n,d]=g.useState({}),[p,j]=g.useState(!1),[f,l]=g.useState(null);g.useEffect(()=>{if(!s.cardNumber){l(null);return}const o=s.cardNumber.replace(/\s/g,"");o.startsWith("4")?l("visa"):o.startsWith("5")&&["1","2","3","4","5"].includes(o[1])||o.startsWith("2")&&parseInt(o.substring(0,4))>=2221&&parseInt(o.substring(0,4))<=2720?l("mastercard"):l(null)},[s.cardNumber]);const x=o=>(o.replace(/\D/g,"").match(/.{1,4}/g)||[]).join(" "),v=o=>{let u=o.replace(/\D/g,"");u.length>16&&(u=u.slice(0,16)),i(_=>E(y({},_),{cardNumber:x(u)}))},N=o=>{let u=o.replace(/\D/g,"");u.length>4&&(u=u.slice(0,4)),u.length>=2&&(u=u.slice(0,2)+"/"+u.slice(2)),i(_=>E(y({},_),{expiryDate:u}))},k=(o,u)=>{const Y=o.replace(/\D/g,"").slice(0,10);i(H=>E(y({},H),{[u]:Y}))},O=()=>{const o={};return c==="personal"?(s.firstName.trim()||(o.firstName="Nombre requerido"),s.lastName.trim()||(o.lastName="Apellido requerido"),s.email.includes("@")||(o.email="Email invÃ¡lido"),s.phone.trim()||(o.phone="TelÃ©fono requerido")):c==="card"?(s.cardNumber.replace(/\s/g,"").length!==16&&(o.cardNumber="NÃºmero de tarjeta debe tener 16 dÃ­gitos"),s.cardHolder.trim()||(o.cardHolder="Nombre del titular requerido"),s.expiryDate.length!==5&&(o.expiryDate="Fecha invÃ¡lida (MM/YY)"),s.cvv.length!==3&&(o.cvv="CVV debe tener 3 dÃ­gitos")):c==="delivery"&&(s.address.trim()||(o.address="DirecciÃ³n requerida"),s.city.trim()||(o.city="Ciudad requerida"),s.department.trim()||(o.department="Departamento requerido"),s.postalCode.trim()||(o.postalCode="CÃ³digo postal requerido"),s.recipientName.trim()||(o.recipientName="Nombre del destinatario requerido"),s.recipientPhone.trim()||(o.recipientPhone="TelÃ©fono del destinatario requerido")),d(o),Object.keys(o).length===0},P=()=>{O()&&(c==="personal"?m("card"):c==="card"?m("delivery"):L())},L=()=>I(F,null,function*(){if(O()){j(!0);try{yield new Promise(o=>setTimeout(o,1e3)),a(Ge({firstName:s.firstName,lastName:s.lastName,email:s.email,phone:s.phone})),a(Ke({cardNumber:s.cardNumber,cardHolder:s.cardHolder,expiryDate:s.expiryDate,cvv:s.cvv,cardType:f})),a(Ye({address:s.address,city:s.city,department:s.department,postalCode:s.postalCode,recipientName:s.recipientName,recipientPhone:s.recipientPhone})),a(G(2)),r()}catch(o){}finally{j(!1)}}}),M=[{id:"personal",title:"Personal",icon:"ðŸ‘¤",description:"InformaciÃ³n personal"},{id:"card",title:"Tarjeta",icon:"ðŸ’³",description:"Datos de la tarjeta"},{id:"delivery",title:"Entrega",icon:"ðŸ“¦",description:"DirecciÃ³n de entrega"}];return t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-neutral-900/80 backdrop-blur-sm z-50 animate-fadeIn",onClick:r}),e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-2 sm:p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl sm:rounded-3xl shadow-strong w-full max-w-2xl max-h-[95vh] sm:max-h-[90vh] flex flex-col animate-scaleIn",children:[e.jsxs("div",{className:"relative bg-gradient-primary text-white p-4 sm:p-6 rounded-t-2xl sm:rounded-t-3xl",children:[e.jsx("button",{onClick:r,className:"absolute top-4 right-4 w-8 h-8 rounded-full hover:bg-white/20 flex items-center justify-center transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"InformaciÃ³n de Pago"}),e.jsx("p",{className:"text-primary-100",children:"Completa los datos para proceder"})]})]}),e.jsx("div",{className:"border-b border-neutral-200 bg-neutral-50",children:e.jsx("div",{className:"flex",children:M.map(o=>e.jsx("button",{onClick:()=>m(o.id),className:`flex-1 px-4 py-4 text-sm font-medium transition-colors ${c===o.id?"text-primary-600 border-b-2 border-primary-600 bg-white":"text-neutral-600 hover:text-neutral-900 hover:bg-neutral-100"}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{className:"text-lg",children:o.icon}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-semibold",children:o.title}),e.jsx("div",{className:"text-xs text-neutral-500",children:o.description})]})]})},o.id))})}),e.jsxs("div",{className:"flex-1 p-4 sm:p-6 overflow-y-auto",children:[c==="personal"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-4",children:"InformaciÃ³n Personal"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Nombre"}),e.jsx("input",{type:"text",value:s.firstName,onChange:o=>i(u=>E(y({},u),{firstName:o.target.value})),className:`input-field ${n.firstName?"input-error":""}`,placeholder:"Tu nombre"}),n.firstName&&e.jsx("p",{className:"text-error-600 text-sm mt-1",children:n.firstName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Apellido"}),e.jsx("input",{type:"text",value:s.lastName,onChange:o=>i(u=>E(y({},u),{lastName:o.target.value})),className:`input-field ${n.lastName?"input-error":""}`,placeholder:"Tu apellido"}),n.lastName&&e.jsx("p",{className:"text-error-600 text-sm mt-1",children:n.lastName})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Email"}),e.jsx("input",{type:"email",value:s.email,onChange:o=>i(u=>E(y({},u),{email:o.target.value})),className:`input-field ${n.email?"input-error":""}`,placeholder:"tu@email.com"}),n.email&&e.jsx("p",{className:"text-error-600 text-sm mt-1",children:n.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"TelÃ©fono"}),e.jsx("input",{type:"tel",value:s.phone,onChange:o=>k(o.target.value,"phone"),className:`input-field ${n.phone?"input-error":""}`,placeholder:"3001234567",maxLength:10}),n.phone&&e.jsx("p",{className:"text-error-600 text-sm mt-1",children:n.phone})]})]}),c==="card"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-4",children:"Datos de la Tarjeta"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"NÃºmero de Tarjeta"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:s.cardNumber,onChange:o=>v(o.target.value),className:`input-field pr-16 ${n.cardNumber?"input-error":""}`,placeholder:"1234 5678 9012 3456",maxLength:19}),e.jsx(at,{cardNumber:s.cardNumber})]}),n.cardNumber&&e.jsx("p",{className:"text-error-600 text-sm mt-1",children:n.cardNumber})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Nombre del Titular"}),e.jsx("input",{type:"text",value:s.cardHolder,onChange:o=>i(u=>E(y({},u),{cardHolder:o.target.value.toUpperCase()})),className:`input-field ${n.cardHolder?"input-error":""}`,placeholder:"NOMBRE COMO APARECE EN LA TARJETA"}),n.cardHolder&&e.jsx("p",{className:"text-error-600 text-sm mt-1",children:n.cardHolder})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Fecha de Vencimiento"}),e.jsx("input",{type:"text",value:s.expiryDate,onChange:o=>N(o.target.value),className:`input-field ${n.expiryDate?"input-error":""}`,placeholder:"MM/YY",maxLength:5}),n.expiryDate&&e.jsx("p",{className:"text-error-600 text-sm mt-1",children:n.expiryDate})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"CVV"}),e.jsx("input",{type:"text",value:s.cvv,onChange:o=>i(u=>E(y({},u),{cvv:o.target.value.replace(/\D/g,"").slice(0,3)})),className:`input-field ${n.cvv?"input-error":""}`,placeholder:"123",maxLength:3}),n.cvv&&e.jsx("p",{className:"text-error-600 text-sm mt-1",children:n.cvv})]})]})]}),c==="delivery"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-4",children:"InformaciÃ³n de Entrega"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"DirecciÃ³n"}),e.jsx("input",{type:"text",value:s.address,onChange:o=>i(u=>E(y({},u),{address:o.target.value})),className:`input-field ${n.address?"input-error":""}`,placeholder:"Calle 123 #45-67"}),n.address&&e.jsx("p",{className:"text-error-600 text-sm mt-1",children:n.address})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Ciudad"}),e.jsx("input",{type:"text",value:s.city,onChange:o=>i(u=>E(y({},u),{city:o.target.value})),className:`input-field ${n.city?"input-error":""}`,placeholder:"MedellÃ­n"}),n.city&&e.jsx("p",{className:"text-error-600 text-sm mt-1",children:n.city})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Departamento"}),e.jsx("input",{type:"text",value:s.department,onChange:o=>i(u=>E(y({},u),{department:o.target.value})),className:`input-field ${n.department?"input-error":""}`,placeholder:"Antioquia"}),n.department&&e.jsx("p",{className:"text-error-600 text-sm mt-1",children:n.department})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"CÃ³digo Postal"}),e.jsx("input",{type:"text",value:s.postalCode,onChange:o=>i(u=>E(y({},u),{postalCode:o.target.value})),className:`input-field ${n.postalCode?"input-error":""}`,placeholder:"05001"}),n.postalCode&&e.jsx("p",{className:"text-error-600 text-sm mt-1",children:n.postalCode})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Nombre del Destinatario"}),e.jsx("input",{type:"text",value:s.recipientName,onChange:o=>i(u=>E(y({},u),{recipientName:o.target.value})),className:`input-field ${n.recipientName?"input-error":""}`,placeholder:"Nombre completo"}),n.recipientName&&e.jsx("p",{className:"text-error-600 text-sm mt-1",children:n.recipientName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"TelÃ©fono del Destinatario"}),e.jsx("input",{type:"tel",value:s.recipientPhone,onChange:o=>k(o.target.value,"recipientPhone"),className:`input-field ${n.recipientPhone?"input-error":""}`,placeholder:"3001234567",maxLength:10}),n.recipientPhone&&e.jsx("p",{className:"text-error-600 text-sm mt-1",children:n.recipientPhone})]})]})]})]}),e.jsx("div",{className:"flex-shrink-0 border-t border-neutral-200 p-4 sm:p-6 bg-neutral-50 rounded-b-3xl",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-stretch sm:items-center gap-3 sm:gap-4",children:[e.jsx("button",{onClick:()=>{c==="personal"?r():m(c==="card"?"personal":"card")},className:"btn-outline px-6 py-3 flex-shrink-0 order-2 sm:order-1",children:c==="personal"?"Cancelar":"Anterior"}),e.jsx("button",{onClick:P,disabled:p,className:`btn-primary px-8 py-3 flex-shrink-0 order-1 sm:order-2 ${p?"opacity-50 cursor-not-allowed":""}`,children:p?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"spinner w-4 h-4"}),e.jsx("span",{children:"Procesando..."})]}):c==="delivery"?e.jsx("span",{children:"Continuar al Resumen"}):e.jsx("span",{children:"Siguiente"})})]})})]})})]}):null},it=()=>{const t=B(),{cartItems:r,cartTotal:a,fees:s}=K(l=>l.payment),[i,c]=g.useState(!1),[m,n]=g.useState(!1),d={baseFee:(s==null?void 0:s.baseFee)||2500,deliveryFee:(s==null?void 0:s.deliveryFee)||5e3,totalAmount:(s==null?void 0:s.totalAmount)||a+((s==null?void 0:s.baseFee)||2500)+((s==null?void 0:s.deliveryFee)||5e3),productAmount:(s==null?void 0:s.productAmount)||a},p=a||0;if(r.length===0)return null;const j=(l,x)=>{x<=0?t(se(l)):t(fe({productId:l,quantity:x}))},f=r.reduce((l,x)=>l+x.quantity,0);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:e.jsx("button",{onClick:()=>c(!0),className:"bg-gradient-primary text-white rounded-2xl w-14 h-14 sm:w-16 sm:h-16 flex items-center justify-center shadow-strong hover:shadow-glow transition-all duration-300 hover:scale-110 group",children:e.jsxs("div",{className:"relative",children:[e.jsx("svg",{className:"w-6 h-6 sm:w-7 sm:h-7 group-hover:scale-110 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.1 5.6a1 1 0 001 1.4h9.2M7 13v6a1 1 0 001 1h8a1 1 0 001-1v-6m-9 1h10"})}),f>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-error-500 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-bounce-soft",children:f>99?"99+":f})]})})}),i&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-neutral-900/50 backdrop-blur-sm z-50 animate-fadeIn",onClick:()=>c(!1)}),e.jsx("div",{className:"fixed inset-y-0 right-0 z-50 w-full max-w-md bg-white shadow-strong animate-slideUp sm:animate-fadeIn",children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-neutral-200 bg-white sticky top-0 z-10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-2xl flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.1 5.6a1 1 0 001 1.4h9.2M7 13v6a1 1 0 001 1h8a1 1 0 001-1v-6m-9 1h10"})})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-neutral-900",children:"Tu Carrito"}),e.jsxs("p",{className:"text-sm text-neutral-600",children:[r.length," producto",r.length!==1?"s":""]})]})]}),e.jsx("button",{onClick:()=>c(!1),className:"w-10 h-10 rounded-xl hover:bg-neutral-100 flex items-center justify-center transition-colors group",children:e.jsx("svg",{className:"w-5 h-5 text-neutral-600 group-hover:text-neutral-900 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[e.jsx("div",{className:"space-y-4",children:r.map((l,x)=>e.jsx("div",{className:"card p-4 animate-slideUp",style:{animationDelay:`${x*100}ms`},children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-primary-100 to-primary-50 rounded-xl flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-2xl",children:"ðŸ“±"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-neutral-900 mb-1 line-clamp-2",children:l.product.name}),e.jsxs("p",{className:"text-sm text-neutral-600 mb-3",children:["$",l.product.price.toLocaleString()," c/u"]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>j(l.product.id,l.quantity-1),className:"w-7 h-7 rounded-lg bg-neutral-100 hover:bg-neutral-200 border border-neutral-200 flex items-center justify-center transition-all hover:scale-105",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),e.jsx("span",{className:"font-semibold text-sm px-2 py-1 bg-primary-50 text-primary-700 rounded-lg border border-primary-200 min-w-[2rem] text-center",children:l.quantity}),e.jsx("button",{onClick:()=>j(l.product.id,l.quantity+1),disabled:l.quantity>=l.product.stock,className:`w-7 h-7 rounded-lg flex items-center justify-center transition-all hover:scale-105 ${l.quantity>=l.product.stock?"bg-neutral-100 text-neutral-400 cursor-not-allowed border border-neutral-200":"bg-primary-600 text-white hover:bg-primary-700 border border-primary-600"}`,children:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold text-primary-600 mb-1",children:["$",(l.product.price*l.quantity).toLocaleString()]}),e.jsxs("button",{onClick:()=>t(se(l.product.id)),className:"text-error-600 hover:text-error-700 text-xs flex items-center gap-1 ml-auto",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Eliminar"]})]})]})]})]})},l.product.id))}),r.length>1&&e.jsxs("button",{onClick:()=>t(Ze()),className:"w-full mt-6 py-3 text-error-600 hover:text-error-700 text-sm font-medium border border-error-200 rounded-xl hover:bg-error-50 transition-all flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Vaciar Carrito"]})]}),e.jsxs("div",{className:"border-t border-neutral-200 p-6 bg-neutral-50 sticky bottom-0",children:[e.jsxs("div",{className:"space-y-2 mb-6",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-neutral-600",children:"Subtotal productos:"}),e.jsxs("span",{className:"font-medium",children:["$",p.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-neutral-600",children:"Tarifa base:"}),e.jsxs("span",{className:"font-medium",children:["$",d.baseFee.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-neutral-600",children:"Costo de envÃ­o:"}),e.jsx("span",{className:"font-medium",children:d.deliveryFee===0?e.jsx("span",{className:"text-success-600 font-bold",children:"GRATIS"}):`$${d.deliveryFee.toFixed(2)}`})]}),e.jsx("div",{className:"border-t border-neutral-300 pt-3 mt-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-bold text-neutral-900",children:"Total:"}),e.jsxs("span",{className:"text-2xl font-bold text-primary-600",children:["$",d.totalAmount.toFixed(2)," COP"]})]})})]}),d.deliveryFee>0&&e.jsx("div",{className:"bg-warning-50 border border-warning-200 rounded-xl p-4 mb-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-warning-600 text-lg",children:"ðŸ’¡"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-warning-800 mb-1",children:"Â¡Casi tienes envÃ­o gratis!"}),e.jsxs("p",{className:"text-xs text-warning-700",children:["Agrega $",Math.max(0,5e4-p).toFixed(2)," mÃ¡s para envÃ­o gratuito"]})]})]})}),e.jsx("button",{onClick:()=>n(!0),disabled:r.length===0,className:`w-full py-4 px-6 rounded-xl text-lg font-semibold transition-all duration-200 transform hover:scale-[1.02] active:scale-[0.98] ${r.length===0?"bg-neutral-300 text-neutral-500 cursor-not-allowed":"bg-gradient-primary text-white shadow-soft hover:shadow-medium"}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),e.jsx("span",{children:"Pagar con Tarjeta de CrÃ©dito"})]})}),e.jsx("button",{onClick:()=>c(!1),className:"w-full mt-3 py-3 px-6 rounded-xl bg-white text-neutral-600 border border-neutral-300 hover:bg-neutral-50 transition-all duration-200 font-medium",children:"Continuar Comprando"}),e.jsx("div",{className:"mt-3 text-center",children:e.jsxs("p",{className:"text-xs text-neutral-500 flex items-center justify-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"Pago seguro con Wompi"]})})]})]})})]}),e.jsx(nt,{isOpen:m,onClose:()=>n(!1)})]})},me=()=>{const t=B(),{cartItems:r}=K(l=>l.payment),[a,s]=g.useState([]),[i,c]=g.useState(!0),[m,n]=g.useState(null);g.useEffect(()=>{I(F,null,function*(){try{c(!0);const x=yield te.getAllProducts();s(x)}catch(x){n(x.message)}finally{c(!1)}})},[]);const d=l=>{t(Qe(l)),t(ze(l))},p=l=>{t(se(l))},j=(l,x)=>{t(fe({productId:l,quantity:x}))},f=l=>{const x=r.find(v=>v.product.id===l);return x?x.quantity:0};return i?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-neutral-50 via-primary-50/20 to-neutral-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center animate-slideUp",children:[e.jsxs("div",{className:"relative mb-8",children:[e.jsx("div",{className:"spinner w-16 h-16 border-4 border-primary-200 border-t-primary-600 mx-auto"}),e.jsx("div",{className:"absolute inset-0 rounded-full bg-primary-100/20 animate-ping"})]}),e.jsx("h3",{className:"text-xl font-semibold text-neutral-800 mb-2",children:"Cargando productos increÃ­bles..."}),e.jsx("p",{className:"text-neutral-600",children:"Preparando la mejor selecciÃ³n para ti"})]})}):m?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-neutral-50 via-error-50/20 to-neutral-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center animate-slideUp",children:[e.jsx("div",{className:"text-6xl mb-6",children:"ðŸ˜ž"}),e.jsx("h3",{className:"text-xl font-semibold text-neutral-800 mb-4",children:"Ups, algo saliÃ³ mal"}),e.jsx("p",{className:"text-neutral-600 mb-6 max-w-md",children:m}),e.jsxs("button",{onClick:()=>{I(F,null,function*(){try{c(!0);const x=yield te.getAllProducts();s(x)}catch(x){n(x.message)}finally{c(!1)}})},className:"btn-primary",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Reintentar"]})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-neutral-50 via-primary-50/20 to-neutral-50",children:[e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary-600/90 to-primary-800/90"}),e.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg%20width%3D%2260%22%20height%3D%2260%22%20viewBox%3D%220%200%2060%2060%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cg%20fill%3D%22%23ffffff%22%20fill-opacity%3D%220.05%22%3E%3Ccircle%20cx%3D%2230%22%20cy%3D%2230%22%20r%3D%222%22/%3E%3C/g%3E%3C/g%3E%3C/svg%3E')] opacity-50"}),e.jsx("div",{className:"relative container-responsive py-16 sm:py-24 lg:py-32",children:e.jsxs("div",{className:"text-center animate-slideUp",children:[e.jsx("div",{className:"text-6xl sm:text-7xl lg:text-8xl mb-6 floating",children:"ðŸ›ï¸"}),e.jsxs("h1",{className:"text-4xl sm:text-5xl lg:text-6xl font-bold text-white mb-6 leading-tight",children:["Descubre Productos",e.jsx("span",{className:"block text-gradient bg-gradient-to-r from-yellow-300 to-orange-300 bg-clip-text text-transparent",children:"Extraordinarios"})]}),e.jsx("p",{className:"text-lg sm:text-xl text-white/90 max-w-2xl mx-auto leading-relaxed",children:"TecnologÃ­a de Ãºltima generaciÃ³n, diseÃ±o excepcional y la mejor experiencia de compra"}),e.jsxs("div",{className:"flex items-center justify-center gap-8 mt-8 text-white/80",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:a.length}),e.jsx("div",{className:"text-sm",children:"Productos"})]}),e.jsx("div",{className:"w-px h-8 bg-white/20"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:"4.9"}),e.jsx("div",{className:"text-sm",children:"Rating"})]}),e.jsx("div",{className:"w-px h-8 bg-white/20"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:"24/7"}),e.jsx("div",{className:"text-sm",children:"Soporte"})]})]})]})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0",children:e.jsx("svg",{className:"w-full h-12 sm:h-16 lg:h-20 text-neutral-50",preserveAspectRatio:"none",viewBox:"0 0 1200 120",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M0,0V60s360,60,600,0S1200,60,1200,60V0Z",className:"fill-current"})})})]}),e.jsxs("div",{className:"container-responsive py-16 sm:py-20 lg:py-24",children:[e.jsxs("div",{className:"text-center mb-12 lg:mb-16",children:[e.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-neutral-900 mb-4",children:"Nuestros Productos"}),e.jsx("p",{className:"text-lg text-neutral-600 max-w-2xl mx-auto",children:"Cada producto ha sido cuidadosamente seleccionado para brindarte la mejor experiencia"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 lg:gap-8",children:a.map((l,x)=>{const v=f(l.id),N=l.stock<=5&&l.stock>0,k=l.stock===0;return e.jsxs("div",{className:"card-interactive group animate-slideUp",style:{animationDelay:`${x*100}ms`},children:[e.jsxs("div",{className:"relative h-48 sm:h-56 bg-gradient-to-br from-primary-100 via-primary-50 to-neutral-100 rounded-t-2xl overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"text-4xl sm:text-5xl group-hover:scale-110 transition-transform duration-300",children:"ðŸ“±"})}),e.jsxs("div",{className:"absolute top-3 right-3 flex flex-col gap-2",children:[k&&e.jsx("span",{className:"badge-error",children:"Sin Stock"}),N&&e.jsxs("span",{className:"badge-warning",children:["Â¡Solo ",l.stock,"!"]}),!k&&!N&&e.jsxs("span",{className:"badge-success",children:[l.stock," disponibles"]})]}),e.jsx("div",{className:"absolute inset-0 bg-primary-600/0 group-hover:bg-primary-600/10 transition-all duration-300"})]}),e.jsxs("div",{className:"p-5 sm:p-6",children:[e.jsx("h3",{className:"font-semibold text-lg text-neutral-900 mb-2 line-clamp-2 min-h-[3.5rem] group-hover:text-primary-700 transition-colors",children:l.name}),e.jsx("p",{className:"text-neutral-600 text-sm mb-4 line-clamp-3 min-h-[4rem]",children:l.description}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsxs("span",{className:"text-2xl sm:text-3xl font-bold text-primary-600",children:["$",l.price.toLocaleString()]}),e.jsx("span",{className:"text-sm text-neutral-500",children:"COP"})]})}),v===0?e.jsx("button",{onClick:()=>d(l),disabled:k,className:`w-full ${k?"btn-outline opacity-50 cursor-not-allowed":"btn-primary"}`,children:k?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636m12.728 12.728L18.364 5.636M5.636 18.364l12.728-12.728"})}),"Agotado"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.1 5.6a1 1 0 001 1.4h9.2M7 13v6a1 1 0 001 1h8a1 1 0 001-1v-6m-9 1h10"})}),"Agregar al Carrito"]})}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between card p-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>j(l.id,v-1),className:"w-8 h-8 rounded-xl bg-neutral-100 hover:bg-neutral-200 border border-neutral-200 flex items-center justify-center transition-all hover:scale-105",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),e.jsx("span",{className:"font-bold text-lg px-3 py-1 bg-primary-50 text-primary-700 rounded-lg border border-primary-200 min-w-[3rem] text-center",children:v}),e.jsx("button",{onClick:()=>j(l.id,v+1),disabled:v>=l.stock,className:`w-8 h-8 rounded-xl flex items-center justify-center transition-all hover:scale-105 ${v>=l.stock?"bg-neutral-100 text-neutral-400 cursor-not-allowed border border-neutral-200":"bg-primary-600 text-white hover:bg-primary-700 border border-primary-600"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-neutral-500",children:"Total"}),e.jsxs("p",{className:"font-bold text-primary-600",children:["$",(l.price*v).toLocaleString()]})]})]}),e.jsxs("button",{onClick:()=>p(l.id),className:"w-full text-error-600 hover:text-error-700 text-sm font-medium py-2 border border-error-200 rounded-xl hover:bg-error-50 transition-all flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Remover"]})]})]}),N&&e.jsx("div",{className:"px-5 pb-5",children:e.jsx("div",{className:"text-xs text-warning-700 bg-warning-100 rounded-xl px-3 py-2 text-center font-medium border border-warning-200",children:"âš ï¸ Â¡Quedan pocas unidades!"})})]},l.id)})}),a.length===0&&!i&&e.jsxs("div",{className:"text-center py-20 animate-slideUp",children:[e.jsx("div",{className:"text-8xl mb-8",children:"ðŸ›ï¸"}),e.jsx("h3",{className:"text-2xl font-semibold text-neutral-900 mb-4",children:"No hay productos disponibles"}),e.jsx("p",{className:"text-neutral-600 text-lg mb-8 max-w-md mx-auto",children:"Estamos preparando productos increÃ­bles para ti. Â¡Vuelve pronto!"}),e.jsxs("button",{onClick:()=>{I(F,null,function*(){try{c(!0);const x=yield te.getAllProducts();s(x)}catch(x){n(x.message)}finally{c(!1)}})},className:"btn-primary",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Recargar Productos"]})]})]}),e.jsx(it,{})]})};class W{static initialize(){}static generateReference(){const r=Date.now(),a=Math.random().toString(36).substring(2,8);return`TX_${r}_${a}`}static blockWompiWidgets(){document.querySelectorAll('script[src*="wompi"], script[src*="checkout"]').forEach(m=>m.remove()),document.querySelectorAll('[id*="wompi"], [class*="wompi"], [data-wompi]').forEach(m=>m.remove());const s=document.createElement;document.createElement=function(m){var d;const n=s.call(this,m);if(m.toLowerCase()==="script"){const p=n,j=(d=Object.getOwnPropertyDescriptor(HTMLScriptElement.prototype,"src"))==null?void 0:d.set;j&&Object.defineProperty(p,"src",{set:function(f){f.includes("wompi")||f.includes("checkout.co")||j.call(this,f)},get:function(){return this.getAttribute("src")||""}})}return n};const i=window.fetch;window.fetch=function(...m){const n=m[0].toString();return n.includes("/widget")||n.includes("/v1/transactions")?Promise.reject(new Error("Widget bloqueado intencionalmente")):i.apply(this,m)},[{name:"wompi-disable-widget",content:"true"},{name:"wompi-form-only",content:"true"},{"http-equiv":"Content-Security-Policy",content:"script-src 'self' 'unsafe-inline'; object-src 'none';"}].forEach(m=>{const n=document.querySelector(`meta[name="${m.name}"], meta[http-equiv="${m["http-equiv"]}"]`);n&&n.remove();const d=document.createElement("meta");Object.entries(m).forEach(([p,j])=>{d.setAttribute(p,j)}),document.head.appendChild(d)})}static processPayment(r,a){return I(this,null,function*(){try{this.blockWompiWidgets();const s=this.generateReference(),i=Math.round(r*100),c={reference:s,amount_in_cents:i,currency:"COP"},m=yield fetch(`${this.BACKEND_URL}/api/payments/integrity`,{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify(c)});if(!m.ok){const f=yield m.text();throw new Error(`Error al generar firma: ${m.status} - ${f}`)}const n=yield m.json(),d=document.createElement("form");d.method="GET",d.action=this.WOMPI_CHECKOUT_URL,d.target="_self",d.style.display="none";const p=[{name:"public-key",value:this.WOMPI_PUBLIC_KEY},{name:"currency",value:"COP"},{name:"amount-in-cents",value:i.toString()},{name:"reference",value:s},{name:"signature:integrity",value:n.integrity},{name:"customer-email",value:a},{name:"redirect-url",value:`${this.FRONTEND_URL}/payment-result`}];p.forEach(f=>{const l=document.createElement("input");l.type="hidden",l.name=f.name,l.value=f.value,d.appendChild(l)});const j=new URLSearchParams;return p.forEach(f=>{j.append(f.name,f.value)}),document.body.appendChild(d),setTimeout(()=>{d.submit()},2e3),{reference:s,amount_in_cents:i,integrity:n.integrity}}catch(s){throw s}})}static getTransactionStatus(r){return I(this,null,function*(){try{const a=yield fetch(`${this.BACKEND_URL}/api/payments/${r}`,{headers:{"ngrok-skip-browser-warning":"true"}});if(!a.ok){const i=new URLSearchParams(window.location.search),c=i.get("reference"),m=i.get("amount_in_cents"),n=i.get("customer-email"),d={reference:c||r,amount:m?(parseInt(m)/100).toString():"0",customer:{firstName:"Cliente",lastName:"Wompi",email:n||"test@wompi.co",phone:"3001234567"},delivery:null,cartItems:[],creditCard:null,paymentMethod:"CARD"},p=yield fetch(`${this.BACKEND_URL}/api/payments/create-transaction`,{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify(d)});if(p.ok)return yield p.json();yield new Promise(f=>setTimeout(f,1e3));const j=yield fetch(`${this.BACKEND_URL}/api/payments/${r}`,{headers:{"ngrok-skip-browser-warning":"true"}});if(j.ok)return yield j.json();throw new Error(`TransacciÃ³n no encontrada: ${r}`)}return yield a.json()}catch(a){throw a}})}}q(W,"WOMPI_CHECKOUT_URL","https://checkout.co.uat.wompi.dev/p/"),q(W,"WOMPI_PUBLIC_KEY","pub_stagtest_g2u0HQd3ZMh05hsSgTS2lUV8t3s4mOt7"),q(W,"BACKEND_URL","https://back-pasarela.onrender.com"),q(W,"FRONTEND_URL","https://main.d10nqda7yg14nv.amplifyapp.com");const lt=()=>{var v;const t=B(),{cartItems:r,customer:a,creditCard:s,delivery:i,fees:c,cartTotal:m}=K(N=>N.payment),[n,d]=g.useState(!1);g.useEffect(()=>{},[]);const p=()=>{t(ge())},j=()=>I(F,null,function*(){d(!0);try{const N=(c==null?void 0:c.baseFee)||0,k=(c==null?void 0:c.deliveryFee)||0,O=m+N+k,P=(a==null?void 0:a.email)||"cliente@test.com";W.initialize();const L=yield W.processPayment(O,P),M={transactionId:L.reference,status:"pending",wompiTransactionId:"",reference:L.reference,amount:O};t(Je(M))}catch(N){alert("Error al procesar el pago. Por favor intenta nuevamente."),d(!1)}});if(!r.length)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No hay productos en el carrito"}),e.jsx("button",{onClick:()=>t(G(1)),className:"text-blue-600 hover:text-blue-700",children:"Volver a productos"})]})});const f=(c==null?void 0:c.baseFee)||0,l=(c==null?void 0:c.deliveryFee)||0,x=m+f+l;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-neutral-900/60 backdrop-blur-sm z-40 animate-fadeIn"}),e.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center",children:e.jsxs("div",{className:"w-full h-full flex flex-col",children:[e.jsx("div",{className:"flex-1 flex items-center justify-center p-6",children:e.jsxs("div",{className:"text-center text-white",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Resumen de Compra"}),e.jsx("p",{className:"text-neutral-300 text-lg",children:"Revisa tu pedido antes de continuar"})]})}),e.jsxs("div",{className:"bg-white rounded-t-3xl shadow-strong max-h-[70vh] overflow-hidden animate-slideUp flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-neutral-200 flex-shrink-0",children:[e.jsx("div",{className:"w-12 h-1 bg-neutral-300 rounded-full mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-center",children:"Confirmar Pago"})]}),e.jsx("div",{className:"overflow-y-auto flex-1",children:e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("h3",{className:"font-semibold text-neutral-900 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:"ðŸ›ï¸"}),"Tu Pedido"]}),e.jsx("div",{className:"space-y-3",children:r.map((N,k)=>e.jsxs("div",{className:"flex justify-between items-center p-4 bg-neutral-50 rounded-xl",style:{animationDelay:`${k*100}ms`},children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-neutral-900",children:N.product.name}),e.jsxs("p",{className:"text-sm text-neutral-600",children:["$",N.product.price.toFixed(2)," x ",N.quantity]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"font-semibold text-neutral-900",children:["$",(N.product.price*N.quantity).toFixed(2)]})})]},N.product.id))}),e.jsxs("div",{className:"mt-6 p-4 bg-neutral-50 rounded-xl space-y-3",children:[e.jsxs("h3",{className:"font-semibold text-neutral-900 flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:"ðŸ’°"}),"Desglose de Costos"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-neutral-600",children:"Subtotal productos:"}),e.jsxs("span",{className:"font-medium",children:["$",m.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-neutral-600",children:"Tarifa base:"}),e.jsxs("span",{className:"font-medium",children:["$",f.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-neutral-600",children:"Costo de envÃ­o:"}),e.jsxs("span",{className:"font-medium",children:["$",l.toFixed(2)]})]}),e.jsxs("div",{className:"border-t pt-2 flex justify-between text-lg font-bold",children:[e.jsx("span",{children:"Total a pagar:"}),e.jsxs("span",{className:"text-primary-600",children:["$",x.toFixed(2)," COP"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-6",children:[e.jsxs("div",{className:"p-4 bg-neutral-50 rounded-xl",children:[e.jsxs("h3",{className:"font-semibold text-neutral-900 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:"ðŸ‘¤"}),"InformaciÃ³n del Cliente"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-neutral-600",children:"Nombre:"}),e.jsxs("span",{className:"font-medium",children:[a==null?void 0:a.firstName," ",a==null?void 0:a.lastName]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-neutral-600",children:"Email:"}),e.jsx("span",{className:"font-medium",children:a==null?void 0:a.email})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-neutral-600",children:"TelÃ©fono:"}),e.jsx("span",{className:"font-medium",children:a==null?void 0:a.phone})]})]})]}),e.jsxs("div",{className:"p-4 bg-neutral-50 rounded-xl",children:[e.jsxs("h3",{className:"font-semibold text-neutral-900 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:"ðŸ’³"}),"InformaciÃ³n de Pago"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-neutral-600",children:"Tarjeta:"}),e.jsxs("span",{className:"font-medium",children:["****",((v=s==null?void 0:s.cardNumber)==null?void 0:v.slice(-4))||"****"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-neutral-600",children:"Titular:"}),e.jsx("span",{className:"font-medium",children:(s==null?void 0:s.cardHolder)||"N/A"})]})]})]}),e.jsxs("div",{className:"p-4 bg-neutral-50 rounded-xl md:col-span-2",children:[e.jsxs("h3",{className:"font-semibold text-neutral-900 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:"ðŸšš"}),"InformaciÃ³n de Entrega"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-neutral-600",children:"DirecciÃ³n:"}),e.jsx("span",{className:"font-medium",children:(i==null?void 0:i.address)||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-neutral-600",children:"Ciudad:"}),e.jsx("span",{className:"font-medium",children:(i==null?void 0:i.city)||"N/A"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-neutral-600",children:"Departamento:"}),e.jsx("span",{className:"font-medium",children:(i==null?void 0:i.department)||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-neutral-600",children:"CÃ³digo postal:"}),e.jsx("span",{className:"font-medium",children:(i==null?void 0:i.postalCode)||"N/A"})]})]})]})]})]})]})}),e.jsxs("div",{className:"p-6 bg-white border-t border-neutral-200 flex-shrink-0 space-y-4",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:p,className:"flex-1 py-4 px-6 bg-neutral-100 text-neutral-700 rounded-xl font-semibold hover:bg-neutral-200 transition-colors",children:"Nuevo Pago"}),e.jsx("button",{onClick:j,disabled:n,className:"flex-2 py-4 px-8 bg-primary-600 text-white rounded-xl font-semibold hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Procesando..."]}):`Pagar $${x.toFixed(2)} COP`})]}),e.jsxs("div",{className:"text-center text-xs text-neutral-500 flex items-center justify-center gap-2",children:[e.jsx("span",{className:"text-green-600",children:"ðŸ”’"}),"Pago seguro con Wompi - Todos tus datos estÃ¡n protegidos"]})]})]})]})})]})},ot=()=>{const t=B(),{currentStep:r,cartItems:a}=K(n=>n.payment);g.useEffect(()=>{a.length===0&&r>1&&t(G(1))},[a.length,r,t]);const s=(n,d,p)=>d?e.jsx("div",{className:"w-8 h-8 bg-success-500 text-white rounded-full flex items-center justify-center shadow-soft",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}):p?e.jsx("div",{className:"w-8 h-8 bg-primary-600 text-white rounded-full flex items-center justify-center shadow-soft animate-pulse-slow",children:e.jsx("span",{className:"text-sm font-bold",children:n})}):e.jsx("div",{className:"w-8 h-8 bg-neutral-300 text-neutral-600 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium",children:n})}),i=[{number:1,title:"Productos",description:"Selecciona y compra"},{number:2,title:"Pagar",description:"Confirmar con Wompi"}],c=()=>e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary-100 via-primary-50 to-transparent opacity-30 rounded-3xl blur-xl"}),e.jsx("div",{className:"relative bg-white/80 backdrop-blur-sm rounded-3xl p-6 shadow-soft border border-white/20",children:e.jsx("div",{className:"flex items-center justify-between",children:i.map((n,d)=>{const p=r>n.number,j=r===n.number;return e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[s(n.number,p,j),e.jsxs("div",{className:"mt-2 text-center",children:[e.jsx("div",{className:`text-sm font-medium ${j?"text-primary-700":p?"text-success-700":"text-neutral-500"}`,children:n.title}),e.jsx("div",{className:"text-xs text-neutral-500 hidden sm:block",children:n.description})]})]}),d<i.length-1&&e.jsx("div",{className:`flex-1 h-0.5 mx-4 ${p?"bg-success-300":"bg-neutral-200"} transition-colors duration-300`})]},n.number)})})})]}),m=()=>{switch(r){case 1:return e.jsx(me,{});case 2:return e.jsx(lt,{});default:return e.jsx(me,{})}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-neutral-50 via-white to-primary-50/30 relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 opacity-30",children:[e.jsx("div",{className:"absolute top-20 left-10 w-72 h-72 bg-gradient-to-br from-primary-200 to-primary-300 rounded-full mix-blend-multiply filter blur-xl animate-blob"}),e.jsx("div",{className:"absolute top-40 right-10 w-72 h-72 bg-gradient-to-br from-purple-200 to-pink-300 rounded-full mix-blend-multiply filter blur-xl animate-blob animation-delay-2000"}),e.jsx("div",{className:"absolute -bottom-8 left-20 w-72 h-72 bg-gradient-to-br from-yellow-200 to-orange-300 rounded-full mix-blend-multiply filter blur-xl animate-blob animation-delay-4000"})]}),e.jsx("div",{className:"relative z-10",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[c(),e.jsx("div",{className:"mt-8",children:m()})]})})]})},ct=()=>{const t=Fe(),r=Oe(),a=B(),s=Le(),[i,c]=g.useState(!0),[m,n]=g.useState(null),[d,p]=g.useState(null),[j,f]=g.useState(!1),l=g.useRef(0),x=g.useRef(null),v=3e3,N=8e3,[k,O]=g.useState("Esperando confirmaciÃ³n de Wompi..."),P=new URLSearchParams(t.search),L=P.get("id"),M=P.get("reference"),o=g.useCallback(()=>I(F,null,function*(){var b,D,$,ne;try{const R=M||L;if(!R)return n("ERROR_NO_REFERENCE"),"ERROR_NO_REFERENCE";const J=yield fetch(`https://back-pasarela.onrender.com/api/payments/${R}`,{headers:{"ngrok-skip-browser-warning":"true"}});if(!J.ok){if(J.status===404){try{const C=yield fetch(`https://back-pasarela.onrender.com/api/payments/${R}/check-wompi`,{headers:{"ngrok-skip-browser-warning":"true"}});if(C.ok){const S=yield C.json();if(S.success&&S.data)return p({id:Date.now(),reference:R,amount:S.data.amount_in_cents/100,status:u(S.data.status),createdAt:S.data.created_at,updatedAt:S.data.updated_at||S.data.created_at,paymentMethod:"Tarjeta de CrÃ©dito",paymentToken:S.data.id,wompiTransactionId:S.data.id,customer:_(),product:Y()}),n(u(S.data.status)),u(S.data.status)}}catch(C){}const h=s.getState(),w=P.get("amount_in_cents")?parseInt(P.get("amount_in_cents"))/100:0,ie=w>0?w:h.payment.cartTotal,Ne={reference:R,amount:ie.toString(),customer:h.payment.customer||{firstName:"Cliente",lastName:"Wompi",email:P.get("customer-email")||"no-email@example.com",phone:"0000000000"},delivery:h.payment.delivery||null,cartItems:h.payment.cartItems||[],creditCard:h.payment.creditCard||null,paymentMethod:P.get("payment_method_type")||"CARD"},le=yield fetch("https://back-pasarela.onrender.com/api/payments/create-transaction",{method:"POST",headers:{"Content-Type":"application/json","ngrok-skip-browser-warning":"true"},body:JSON.stringify(Ne)});if(le.ok){const C=yield le.json();if(C.success)return p({id:C.data.id,reference:C.data.reference||R,amount:ie,status:C.data.status,createdAt:C.data.createdAt,updatedAt:C.data.updatedAt,paymentMethod:C.data.paymentMethod||"Tarjeta de CrÃ©dito",paymentToken:C.data.paymentToken,customer:h.payment.customer?{id:0,firstName:h.payment.customer.firstName,lastName:h.payment.customer.lastName,email:h.payment.customer.email,phone:h.payment.customer.phone,documentType:"",documentNumber:""}:void 0,product:(D=(b=h.payment.cartItems)==null?void 0:b[0])!=null&&D.product?{id:parseInt(h.payment.cartItems[0].product.id.toString()),name:h.payment.cartItems[0].product.name,description:h.payment.cartItems[0].product.description,price:parseFloat(h.payment.cartItems[0].product.price.toString()),stock:h.payment.cartItems[0].product.stock}:void 0,wompiTransactionId:C.data.wompiTransactionId}),n(C.data.status),C.data.status}}return n("ERROR_CONSULTA"),"ERROR_CONSULTA"}const A=yield J.json();if(A.success&&A.data){const h=A.data,w=s.getState();return p({id:h.id,reference:h.reference||R,amount:h.amount>0?h.amount:w.payment.cartTotal,status:h.status,createdAt:h.createdAt,updatedAt:h.updatedAt,paymentMethod:h.paymentMethod||"Tarjeta de CrÃ©dito",paymentToken:h.paymentToken,customer:h.customer||(w.payment.customer?{id:0,firstName:w.payment.customer.firstName,lastName:w.payment.customer.lastName,email:w.payment.customer.email,phone:w.payment.customer.phone,documentType:"",documentNumber:""}:void 0),product:h.product||((ne=($=w.payment.cartItems)==null?void 0:$[0])!=null&&ne.product?{id:parseInt(w.payment.cartItems[0].product.id.toString()),name:w.payment.cartItems[0].product.name,description:w.payment.cartItems[0].product.description,price:parseFloat(w.payment.cartItems[0].product.price.toString()),stock:w.payment.cartItems[0].product.stock}:void 0),wompiTransactionId:h.wompiTransactionId}),n(h.status),h.status}else return n((A==null?void 0:A.status)||"ERROR_CONSULTA"),(A==null?void 0:A.status)||"ERROR_CONSULTA"}catch(R){return n("ERROR_NETWORK"),"ERROR_NETWORK"}}),[M,L,s]),u=b=>({APPROVED:"APPROVED",PENDING:"PENDING",DECLINED:"DECLINED",VOIDED:"FAILED",ERROR:"FAILED",FAILED:"FAILED"})[b]||"PENDING",_=()=>{const b=s.getState();return b.payment.customer?{id:0,firstName:b.payment.customer.firstName,lastName:b.payment.customer.lastName,email:b.payment.customer.email,phone:b.payment.customer.phone,documentType:"",documentNumber:""}:void 0},Y=()=>{var D,$;const b=s.getState();return($=(D=b.payment.cartItems)==null?void 0:D[0])!=null&&$.product?{id:parseInt(b.payment.cartItems[0].product.id.toString()),name:b.payment.cartItems[0].product.name,description:b.payment.cartItems[0].product.description,price:parseFloat(b.payment.cartItems[0].product.price.toString()),stock:b.payment.cartItems[0].product.stock}:void 0};g.useEffect(()=>{let b=!0;l.current===0&&c(!0);const D=()=>I(F,null,function*(){x.current&&window.clearTimeout(x.current),l.current+=1,l.current%15===0&&O(`AÃºn esperando confirmaciÃ³n de Wompi... (${Math.floor(l.current/7.5)} minutos)`),b&&f(!0);const $=yield o();b&&(i&&c(!1),$==="PENDING"?x.current=window.setTimeout(D,N):f(!1))});return l.current=0,x.current=window.setTimeout(D,v),()=>{b=!1,x.current&&window.clearTimeout(x.current),f(!1)}},[o,i]);const H=b=>typeof b!="number"||isNaN(b)?"$ 0":new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(b),be=()=>{switch(m){case"COMPLETED":case"APPROVED":return{icon:"âœ…",title:"Â¡Pago Exitoso!",message:"Tu compra ha sido procesada correctamente.",color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200"};case"PENDING":case"PROCESSING":return{icon:"â°",title:"Pago en Proceso",message:"Tu pago estÃ¡ siendo procesado. Te notificaremos cuando se complete.",color:"text-yellow-600",bgColor:"bg-yellow-50",borderColor:"border-yellow-200"};case"FAILED":case"REJECTED":case"DECLINED":return{icon:"âŒ",title:"Pago Rechazado",message:"Tu pago fue rechazado. Por favor, intenta con otro mÃ©todo o contacta a tu banco.",color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200"};default:return{icon:"â“",title:"Estado del Pago",message:`No se pudo confirmar el estado final de tu pago. Referencia: ${M||L}. Contacta a soporte si el problema persiste.`,color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200"}}},ae=()=>{a(ge()),a(G(1)),r("/")};if(i&&!d)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"p-8 bg-white rounded-lg shadow-lg text-center max-w-md w-full mx-4",children:[e.jsx("div",{className:"animate-spin w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Verificando tu pago..."}),e.jsx("p",{className:"text-gray-600",children:"Por favor espera mientras confirmamos el estado de tu transacciÃ³n."})]})});const T=be();return!d&&!i&&m!=="PENDING"&&m!=="APPROVED"?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white shadow-xl rounded-lg p-8 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:T.icon}),e.jsx("h2",{className:`text-2xl font-bold ${T.color} mb-4`,children:T.title}),e.jsx("p",{className:"text-gray-600 mb-6",children:T.message}),e.jsx("button",{onClick:ae,className:"w-full px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"Volver a la Tienda"})]})}):e.jsx("div",{className:"min-h-screen bg-gray-100 py-8 px-4",children:e.jsx("div",{className:"max-w-3xl mx-auto",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-lg overflow-hidden",children:[e.jsxs("div",{className:`p-6 text-center border-b ${T.bgColor} ${T.borderColor}`,children:[e.jsxs("div",{className:"flex justify-center items-center mb-4",children:[e.jsx("div",{className:"text-6xl",children:T.icon}),j&&m==="PENDING"&&e.jsx("div",{className:"ml-4 animate-spin w-8 h-8 border-4 border-yellow-500 border-t-transparent rounded-full"})]}),e.jsx("h1",{className:`text-3xl font-bold ${T.color} mb-2`,children:T.title}),e.jsx("p",{className:"text-gray-600 text-lg",children:T.message}),j&&m==="PENDING"&&e.jsx("p",{className:"mt-3 text-sm text-yellow-600 font-medium",children:k})]}),d&&e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:"ðŸ“„ InformaciÃ³n de la TransacciÃ³n"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Referencia"}),e.jsx("p",{className:"font-semibold text-gray-900",children:d.reference})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"ID Wompi"}),e.jsx("p",{className:"font-semibold text-gray-900",children:d.wompiTransactionId||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Fecha y Hora"}),e.jsx("p",{className:"font-semibold text-gray-900",children:d.createdAt?new Date(d.createdAt).toLocaleString("es-CO"):"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"MÃ©todo de Pago"}),e.jsx("p",{className:"font-semibold text-gray-900",children:d.paymentMethod})]})]})]}),d.customer&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:"ðŸ‘¤ InformaciÃ³n del Cliente"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Nombre"}),e.jsxs("p",{className:"font-semibold text-gray-900",children:[d.customer.firstName," ",d.customer.lastName]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Email"}),e.jsx("p",{className:"font-semibold text-gray-900",children:d.customer.email})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"TelÃ©fono"}),e.jsx("p",{className:"font-semibold text-gray-900",children:d.customer.phone})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Documento"}),e.jsxs("p",{className:"font-semibold text-gray-900",children:[d.customer.documentType," ",d.customer.documentNumber]})]})]})]}),d.product&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:"ðŸ›ï¸ Producto Comprado"}),e.jsx("div",{className:"p-4 bg-green-50 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-lg",children:d.product.name}),e.jsx("p",{className:"text-gray-600 mt-1",children:d.product.description}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Cantidad: 1"})]}),e.jsx("div",{className:"text-right ml-4",children:e.jsx("p",{className:"text-2xl font-bold text-green-600",children:H(d.product.price)})})]})})]}),e.jsx("div",{className:"border-t pt-6",children:e.jsxs("div",{className:"flex justify-between items-center text-2xl font-bold",children:[e.jsx("span",{className:"text-gray-700",children:"TOTAL PAGADO:"}),e.jsx("span",{className:"text-blue-600",children:H(d.amount)})]})})]}),e.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t flex justify-center",children:e.jsx("button",{onClick:ae,className:"px-8 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold",children:"Volver a la Tienda"})})]})})})},dt=()=>e.jsx(Me,{children:e.jsx("div",{className:"App",children:e.jsxs(_e,{children:[e.jsx(Z,{path:"/",element:e.jsx(ot,{})}),e.jsx(Z,{path:"/payment-result",element:e.jsx(ct,{})}),e.jsx(Z,{path:"*",element:e.jsx($e,{to:"/",replace:!0})})]})})}),mt=document.getElementById("root"),ut=pe(mt);ut.render(e.jsx(Se.StrictMode,{children:e.jsx(Re,{store:re,children:e.jsx(dt,{})})}))});export default xt();
